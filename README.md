---

# 🐶 みんなでどうぶつクイズ！ (Animal Voice Quiz)

<img src="./public/images/title.png" alt="App Screenshot" width="400">

* 声で答えて遊ぶ、子供向けの参加型クイズWebアプリです。
* 画面を触らず、みんなで声を出して楽しめます。
* 「これなーんだ？」と聞くのではなく、子供が自分の声で元気よく答えることで、判断力と発語を促します。

---

## 🎮 遊び方

1. **スタートボタン**を押すとゲーム開始！ (画像ロードを待つため、ボタンは少し遅れてふわっと現れます)
2. 画面に表示される画像を見て、その名前を叫んでください。
3. ・どうぶつなら → 名前を言ってね
・どうぶつじゃなかったら → 「どうぶつじゃない！」でもOK
4. 正解するとAI音声が褒めてくれます。
5. 全10問のランダム出題。最後に集めたキャラクターのコレクション画面が見られます。

---

## ✨ 特徴

* **爆速の画像表示 (3段階プリロード)**: 独自の先行読み込みロジックにより、クイズ中の画像切り替え待ちをゼロに。1問目からストレスなくパッと表示されます。
* **誤認識・誤爆を徹底ガード**: 子供の「あ！ワンワンだ」という声は拾いつつ、周囲の大人の会話やノイズで勝手に正解にならないよう、独自の判定アルゴリズムを搭載。
* **完全ハンズフリー**: スタートボタン以外は操作不要。子供が画面をベタベタ触る必要がなく、端末が汚れません。
* **判断力を育てる「ひっかけ問題」**: 「動物に見えるけど違う」問題が含まれており、「動物じゃありませーん！」と本質を見抜いて答える判断力を養います。
* **Web Speech API活用**: ブラウザ標準の機能を使用しているため、追加のAPIキーや利用料なしで動作します。

---

## 🛠 技術的なこだわり

※ 以下は「なぜ子供がストレスなく遊べるか」を支える裏側の工夫です。

### 1. 3段階の「ストリーミング・プリロード」

画像の表示遅延による興奮の断絶を防ぐため、裏側で常に先回りして画像をダウンロードします。

* **タイトル画面**: 表示からボタンが出るまでの「タメ」の間に Q1, Q2 をロード。
* **スタート演出中**: 「スタート！」の音声が流れている隙に Q3〜Q5 をロード。
* **回答中**: 正解した瞬間に「2問先」の画像をロードするスライディング・ウィンドウ方式を採用。

### 2. 音声認識の「地雷」対策と安定化

日本語の音声認識において誤認識されやすい短い言葉（「ゾウ」など）を排除し、ロジック側でもガードを実装しました。

* **特定動物の入れ替え**: 誤爆しやすい「ゾウ」を、音節が長く認識が極めて安定する「カンガルー」に変更。
* **厳格マッチング**: 2文字以下の短い正解（イヌ、ウマ等）は「完全一致」または「前方一致」のみを許可し、日常のノイズ（「あー」「そう」等）による誤判定を物理的に防ぎました。
* **マイク制御の安定化**: 音声合成のキャンセル時に発生するエラーを適切に処理し、マイクが沈黙（復帰不能）するリスクを最小化。

### 3. おもちゃのような即応性

* **100ms判定**: 音声認識の確定待ちを極限まで削り、喋った瞬間に反応する「魔法感」を実現しました。
* **UIによる誘導**: タイトルボタンのフェードインや「せーの！」モードにより、子供が喋り出すタイミングを自然にコントロールします。

---

## 🛠 使用技術

* **Framework**: Next.js 14 (App Router)
* **Language**: TypeScript
* **Styling**: Tailwind CSS
* **Voice**: Web Speech API (Recognition & Synthesis)
* **Effect**: canvas-confetti
* **Deployment**: Vercel

---

## 🚀 ローカルでの実行方法

```bash
# リポジトリのクローン
git clone https://github.com/your-username/animal-quiz.git

# ディレクトリ移動
cd animal-quiz

# 依存関係のインストール
npm install

# 開発サーバー起動
npm run dev

# ブラウザで http://localhost:3000 を開いてください。（音声認識のためGoogle Chrome推奨）

```

---

## 📂 ディレクトリ構成

* `app/data/questions.ts`: 出題データ（エイリアス、解説、特殊反応設定）
* `app/hooks/useGameEngine.ts`: クイズの進行、判定、画像ロード制御ロジック
* `app/hooks/useSpeechRecognition.ts`: 音声認識の制御とエラーハンドリング
* `app/hooks/useVoiceController.ts`: ブラウザ音声合成の制御（中断処理・エラーガード）
* `app/components/`: UIコンポーネント（タイトル、ゲーム画面、リザルト）

---

## 🚀 今後の展望

* OpenAI APIを導入し、より自然で感情豊かな音声対話の実装
* 難易度選択（かんたん・ふつう・むずかしい）の追加
* PWA化によるホーム画面への追加対応
* 保育園・教育現場向けに、出題セットを差し替えられる汎用クイズフレームワーク化

---

**【開発者メッセージ】**
お正月など、家族が集まるリビングで、スマホを置いて全員で叫んで遊ぶシーンを想定して作りました。
「タップ」ではなく「声」で世界と繋がる楽しさを、子供たちに体験してほしいと思っています。

---
